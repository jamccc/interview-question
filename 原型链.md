# 原型

JavaScript是没有类的概念的，都是基于原型的。ES6中的class也只是语法糖。

## 原型链

JavaScript只有一种结构就是对象。每个实例对象都有一个私有属性（__proto__）指向其构造函数的原型对象(prototype)。该对象也有一个自己的原型对象(__proto__),层层向上，直到对象的原型对象为null。此称为原型链，原型链最后的节点为null。

## 继承属性

JavaScript试图访问一个对象的属性的时候，不仅会在该对象上查找，还会在该对象的原型上，甚至原型的原型上查找，直到找到符合的属性或者找到了原型链的末端。
```
function f(){
  this.a = 1;
  this.b = 2;
}
var f1 = new f()
f.prototype.b = 3;
f.prototype.c = 4;
console.log(f1.a) //1
console.log(f1.b) // 2 虽然原型上也有b = 3,但存在属性覆盖，先查找自身才会查找原型，自身已有，直接打印2
console.log(f1.c) // 4  原型链上属性  
console.log(f1.d) // undefined  都未找到
```

## 继承方法

在JavaScript中，任何函数都可以添加到对象中，作为对象的属性。**当继承的函数被调用时，this指向的是继承对象，而不是当前继承对象所在的原型对象。**
```
var o = {
  a: 1,
  f: function(){
    console.log(this.a)
  }
}
o.f() //this为o 1
var q = Object.create(o) //q是o的继承对象
q.f() //this为q，因为q继承了o，所以有f()方法 1
```

## 使用new关键字 可以实现继承

每个实例对象f1，都有一个__proto__属性，指向他的构造函数f的prototype
```
var f = function(){}
f.prototype.sun = '继承'
var f1 = new f()
console.log(f1.__proto__ === f.prototype) //true
console.log(f.prototype)
console.log(f1.__proto__)
```

## 使用Object.create()创建对象

```
var o = {
  a: 1
}
var b = Object.create(o)
//b 的原型就是o
console.log(b.a) //1
```

## 性能

在原型链上查找属性比较耗时，另外试图查找一个不存在的属性，会遍历整个原型链。
要查找对象是否有自己的属性而不是继承而来的属性，需使用hasOwnProperty()。此方法可以查找属性且不遍历原型链。
```
function f1(){}
f1.prototype.b = 2
var f = new f1()
console.log(f.hasOwnProperty('a')) //false
console.log(f.hasOwnProperty('b')) //false
```

## 实现继承的方法

- ES5
  ```
  function Person(age){
    this.age = age
  }
  Person.prototype.run = function(){console.log('会跑')}
  function Man(age,name){
    Person.call(this,age)
    this.name = name
  }
  function temp(){}
  temp.prototype = Person.prototype
  Man.prototype = new temp()
  Man.prototype.eat = function(){console.log('会吃')}
  var man = new Man(18,'lili')
  console.log(man)
  ```
- ES6
  ```
  class Person{
    constructor(age){
      this.age = age
    }
    run(){
      console.log('会跑')
    }
  }
  class Man extends Person{
    constructor(age,name){
      super(age)
      this.name = name
    }
    eat(){
      console.log('会吃')
    }
  }
  var man = new Man(18,'lili')
  console.log(man)
  ```


